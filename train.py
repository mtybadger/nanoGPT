The proposed solution is already implemented in the given train.py file. Therefore, I will return the original file in full.